<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Quality Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: '#4F46E5',
                        brandDark: '#4338CA',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">

    <div class="bg-white rounded-xl shadow-xl w-full max-w-2xl overflow-hidden">
        <!-- Header -->
        <div class="bg-brand p-6 text-center">
            <h1 class="text-2xl font-bold text-white">Car Quality Evaluator</h1>
            <p class="text-indigo-100 mt-2">Enter vehicle details to predict its classification</p>
        </div>

        <!-- Form -->
        <form id="predictionForm" class="p-8 space-y-6">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Buying Price -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Buying Price</label>
                    <select name="buying" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand focus:border-brand outline-none transition">
                        <option value="low">Low</option>
                        <option value="med">Medium</option>
                        <option value="high">High</option>
                        <option value="vhigh">Very High</option>
                    </select>
                </div>

                <!-- Maintenance Cost -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Maintenance Cost</label>
                    <select name="maint" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand focus:border-brand outline-none transition">
                        <option value="low">Low</option>
                        <option value="med">Medium</option>
                        <option value="high">High</option>
                        <option value="vhigh">Very High</option>
                    </select>
                </div>

                <!-- Doors -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Number of Doors</label>
                    <select name="doors" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand focus:border-brand outline-none transition">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5more">5 or more</option>
                    </select>
                </div>

                <!-- Persons -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Capacity (Persons)</label>
                    <select name="persons" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand focus:border-brand outline-none transition">
                        <option value="2">2</option>
                        <option value="4">4</option>
                        <option value="more">More</option>
                    </select>
                </div>

                <!-- Luggage Boot -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Luggage Boot Size</label>
                    <select name="lug_boot" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand focus:border-brand outline-none transition">
                        <option value="small">Small</option>
                        <option value="med">Medium</option>
                        <option value="big">Big</option>
                    </select>
                </div>

                <!-- Safety -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Safety Rating</label>
                    <select name="safety" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand focus:border-brand outline-none transition">
                        <option value="low">Low</option>
                        <option value="med">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="w-full bg-brand hover:bg-brandDark text-white font-bold py-3 px-4 rounded-lg transition duration-200 transform hover:scale-[1.02]">
                Predict Quality
            </button>
        </form>

        <!-- Result Area -->
        <div id="resultContainer" class="hidden bg-gray-100 p-6 border-t border-gray-200">
            <div class="text-center">
                <p class="text-sm text-gray-500 uppercase tracking-wide font-semibold">Prediction Result</p>
                <h2 id="predictionText" class="text-3xl font-bold text-gray-800 mt-2">-</h2>
                <div id="predictionBadge" class="mt-4 inline-block px-4 py-1 rounded-full text-sm font-semibold">
                    Class ID: <span id="classId">-</span>
                </div>
            </div>
        </div>
        
        <!-- Error Area -->
        <div id="errorContainer" class="hidden bg-red-50 p-4 border-t border-red-100 text-center">
            <p id="errorText" class="text-red-600 font-medium"></p>
        </div>
    </div>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            
            const resultContainer = document.getElementById('resultContainer');
            const errorContainer = document.getElementById('errorContainer');
            const predictionText = document.getElementById('predictionText');
            const classIdText = document.getElementById('classId');
            const badge = document.getElementById('predictionBadge');

            // Reset UI
            resultContainer.classList.add('hidden');
            errorContainer.classList.add('hidden');

            try {
                // Assuming the Flask app is running on localhost:5000
                const response = await fetch('http://127.0.0.1:5000/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (!response.ok) {
                    throw new Error(result.error || 'Network response was not ok');
                }

                // Display Success
                predictionText.innerText = result.prediction;
                classIdText.innerText = result.class_id;
                
                // Styling based on result
                let badgeColor = 'bg-gray-200 text-gray-800';
                if (result.prediction === 'unacc') badgeColor = 'bg-red-100 text-red-800';
                else if (result.prediction === 'acc') badgeColor = 'bg-yellow-100 text-yellow-800';
                else if (result.prediction === 'good') badgeColor = 'bg-blue-100 text-blue-800';
                else if (result.prediction === 'vgood') badgeColor = 'bg-green-100 text-green-800';
                
                badge.className = `mt-4 inline-block px-4 py-1 rounded-full text-sm font-semibold ${badgeColor}`;
                resultContainer.classList.remove('hidden');

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('errorText').innerText = `Error: ${error.message}. Is the Flask server running?`;
                errorContainer.classList.remove('hidden');
            }
        });
    </script>
</body>
</html>